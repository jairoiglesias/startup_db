{"version":3,"sources":["index.js"],"names":[],"mappings":"AAAA;;;;;;;;;;;;kBAIe,YAAM;AACnB,SAAO,UAAC,GAAD,EAAM,GAAN,EAAW,IAAX,EAAoB;AACzB,QAAM,OAAO,IAAI,GAAJ,CAAQ,eAAR,CAAP,CADmB;;AAGzB,QAAI,CAAC,IAAD,EAAO;AACT,aAAO,IAAI,MAAJ,CAAW,GAAX,EAAgB,GAAhB,CAAoB,kBAApB,EAAwC,WAAxC,EAAqD,GAArD,EAAP,CADS;KAAX;;AAIA,QAAI,KAAK,WAAL,CAAiB,WAAjB,MAAkC,CAAlC,EAAqC;AACvC,aAAO,KAAK,0BAAY,GAAZ,sCAAmD,IAAnD,CAAL,CAAP,CADuC;KAAzC;;AAIA,QAAI,IAAJ,GAAW,IAAI,IAAJ,IAAY,EAAZ,CAXc;AAYzB,QAAI,IAAJ,CAAS,KAAT,GAAiB,KAAK,SAAL,CAAe,aAAa,MAAb,CAAhC,CAZyB;;AAczB,WAdyB;GAApB,CADY;CAAN","file":"index.js","sourcesContent":["'use strict';\r\n\r\nimport createError from 'http-errors';\r\n\r\nexport default () => {\r\n  return (req, res, next) => {\r\n    const auth = req.get('authorization');\r\n\r\n    if (!auth) {\r\n      return res.status(401).set('WWW-Authenticate', 'Negotiate').end();\r\n    }\r\n\r\n    if (auth.lastIndexOf('Negotiate') !== 0) {\r\n      return next(createError(400, `Malformed authentication token ${auth}`));\r\n    }\r\n\r\n    req.auth = req.auth || {};\r\n    req.auth.token = auth.substring('Negotiate '.length);\r\n\r\n    next();\r\n  };\r\n};\r\n"],"sourceRoot":"/source/"}